FROM ollama/ollama:latest

# Create a startup script that pulls models on first run
RUN echo '#!/bin/bash\n\
ollama serve &\n\
OLLAMA_PID=$!\n\
sleep 5\n\
\n\
# Pull models in background\n\
(\n\
  ollama pull gemma2:2b\n\
  ollama pull qwen2.5:3b\n\
  ollama pull llama3.2:1b\n\
) &\n\
\n\
wait $OLLAMA_PID\n\
' > /usr/local/bin/start-ollama.sh && \
    chmod +x /usr/local/bin/start-ollama.sh

EXPOSE 11434
ENTRYPOINT ["/usr/local/bin/start-ollama.sh"]
